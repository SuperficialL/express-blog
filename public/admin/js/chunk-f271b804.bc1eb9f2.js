(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f271b804"],{"04ee":function(t,e,n){"use strict";var r=n("3868"),a=n.n(r);a.a},3868:function(t,e,n){},7354:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",[n("h1",[t._v(t._s(t.id?"编辑":"新建")+"文章")]),n("el-form",{ref:"form",attrs:{"label-width":"100px",model:t.model,rules:t.rules},nativeOn:{submit:function(e){return e.preventDefault(),t.save("form")}}},[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{model:{value:t.model.title,callback:function(e){t.$set(t.model,"title",e)},expression:"model.title"}})],1),n("el-form-item",{attrs:{label:"文章状态"}},[n("el-tooltip",{attrs:{content:t._f("statusFilter")(t.model.status),placement:"top"}},[n("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-text":"发表","inactive-text":"草稿","active-value":1,"inactive-value":0,size:"middle"},model:{value:t.model.status,callback:function(e){t.$set(t.model,"status",e)},expression:"model.status"}})],1)],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"作者:"}},[n("el-select",{attrs:{"value-key":"username",placeholder:"搜索用户"},model:{value:t.model.author,callback:function(e){t.$set(t.model,"author",e)},expression:"model.author"}},t._l(t.userListOptions,(function(t,e){return n("el-option",{key:e,attrs:{label:t.username,value:t}})})),1)],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"标签:"}},[n("el-select",{attrs:{"value-key":"title",multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"搜索标签"},model:{value:t.model.tags,callback:function(e){t.$set(t.model,"tags",e)},expression:"model.tags"}},t._l(t.tagListOptions,(function(t,e){return n("el-option",{key:e,attrs:{label:t.title,value:t}})})),1)],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"分类:"}},[n("el-select",{attrs:{"value-key":"name",filterable:"","allow-create":"","default-first-option":"",placeholder:"搜索分类"},model:{value:t.model.category,callback:function(e){t.$set(t.model,"category",e)},expression:"model.category"}},t._l(t.catListOptions,(function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t}})})),1)],1),n("el-form-item",{attrs:{label:"缩略图:"}},[n("el-upload",{attrs:{"list-type":"picture-card",accept:"image/*",headers:t.getAuthHeaders(),action:t.uploadUrl,"on-preview":t.handlePictureCardPreview,"on-success":t.UploadSuccess,"on-remove":t.handleRemove}},[t.model.thumbnail?n("img",{staticClass:"avatar",attrs:{src:t.model.thumbnail}}):t._e(),n("i",{staticClass:"el-icon-plus"})]),n("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("img",{attrs:{width:"100%",src:t.model.thumbnail}})])],1),n("mavon-editor",{on:{change:t.saveMavon,imgAdd:t.imgAdd,imgDel:t.imgDel},model:{value:t.model.content,callback:function(e){t.$set(t.model,"content",e)},expression:"model.content"}}),n("el-form-item",[n("el-button",{attrs:{type:"primary","native-type":"submit"}},[t._v("保存")])],1)],1)],1)])},a=[],i=(n("96cf"),n("3b8d")),o=n("8691"),c=n("c405"),s=n("8020"),u=n("2612"),l=n("b775");function d(t){return Object(l["a"])({url:"uploads",method:"post",data:t})}var m={name:"PostDetail",props:["id"],data:function(){return{model:{},imgs:{},rules:{title:[{required:!0,message:"文章标题不可为空~",trigger:"blur"}]},dialogVisible:!1,loading:!1,pickerOptions:{shortcuts:[{text:"今天",onClick:function(t){t.$emit("pick",new Date)}},{text:"昨天",onClick:function(t){var e=new Date;e.setTime(e.getTime()-864e5),t.$emit("pick",e)}},{text:"一周前",onClick:function(t){var e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",e)}}]},userListOptions:[],tagListOptions:[],catListOptions:[]}},methods:{handleRemove:function(t,e){window.console.log(t,e)},handlePictureCardPreview:function(t){this.model.thumbnail=t.url,this.dialogVisible=!0},fetchArticle:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["c"])(this.id);case 2:e=t.sent,200===e.code&&(this.model=e.data);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchCategories:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["c"])();case 2:e=t.sent,200===e.code&&(this.catListOptions=e.data.categories);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchAuthors:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["e"])();case 2:e=t.sent,200===e.code&&(this.userListOptions=e.data.users);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),fetchTags:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["d"])();case 2:e=t.sent,200===e.code&&(this.tagListOptions=e.data.tags);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),save:function(t){var e=this;this.loading=!0,this.$refs[t].validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=13;break}if(!e.id){t.next=7;break}return t.next=4,Object(o["e"])(e.id,e.model);case 4:r=t.sent,t.next=10;break;case 7:return t.next=9,Object(o["a"])(e.model);case 9:r=t.sent;case 10:200===r.code&&(e.loading=!1,e.$router.push("/post/list?refresh=1"),e.$message({type:"success",message:"保存成功~"})),t.next=14;break;case 13:e.$message.error("验证失败~");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},saveMavon:function(t,e){this.model.renderContent=e},imgAdd:function(t,e){this.imgs[t]=e},imgDel:function(t){delete this.imgs[t]},uploadRichTextImg:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n in e=new FormData,this.imgs)e.append(n,this.imgs[n]);return t.next=4,d();case 4:r=t.sent,console.log(r,"res");case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),UploadSuccess:function(t){this.$set(this.model,"thumbnail",t.url)}},created:function(){this.id&&this.fetchArticle(),this.fetchCategories(),this.fetchAuthors(),this.fetchTags()}},f=m,p=(n("04ee"),n("2877")),h=Object(p["a"])(f,r,a,!1,null,"44a930d7",null);e["default"]=h.exports},8020:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return s}));var r=n("b775");function a(t){return Object(r["a"])({url:"tags",method:"get",params:t})}function i(t){return Object(r["a"])({url:"tags/".concat(t),method:"get"})}function o(t){return Object(r["a"])({url:"tags",method:"post",data:t})}function c(t,e){return Object(r["a"])({url:"tags/".concat(t),method:"patch",data:e})}function s(t){return Object(r["a"])({url:"tags/".concat(t),method:"delete"})}},8691:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return s}));var r=n("b775");function a(t){return Object(r["a"])({url:"articles/".concat(t),method:"get"})}function i(t){return Object(r["a"])({url:"articles",method:"get",params:t})}function o(t){return Object(r["a"])({url:"articles",method:"post",data:t})}function c(t,e){return Object(r["a"])({url:"articles/".concat(t),method:"patch",data:e})}function s(t){return Object(r["a"])({url:"articles/".concat(t),method:"delete"})}},c405:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return c})),n.d(e,"b",(function(){return s}));var r=n("b775");function a(t){return Object(r["a"])({url:"categories/".concat(t),method:"get"})}function i(t){return Object(r["a"])({url:"categories",method:"get",params:t})}function o(t){return Object(r["a"])({url:"categories",method:"post",data:t})}function c(t,e){return Object(r["a"])({url:"categories/".concat(t),method:"patch",data:e})}function s(t){return Object(r["a"])({url:"categories/".concat(t),method:"delete"})}}}]);