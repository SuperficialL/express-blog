(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28c7ea5e"],{"184f":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("h1",[e._v(e._s(e.id?"编辑":"新建")+"文章")]),n("el-form",{ref:"form",attrs:{"label-width":"100px",model:e.model,rules:e.rules},nativeOn:{submit:function(t){return t.preventDefault(),e.save("form")}}},[n("el-form-item",{attrs:{label:"标题",prop:"title"}},[n("el-input",{model:{value:e.model.title,callback:function(t){e.$set(e.model,"title",t)},expression:"model.title"}})],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"作者:"}},[n("el-select",{attrs:{"value-key":"username",placeholder:"搜索用户"},model:{value:e.model.author,callback:function(t){e.$set(e.model,"author",t)},expression:"model.author"}},e._l(e.userListOptions,(function(e,t){return n("el-option",{key:t,attrs:{label:e.username,value:e}})})),1)],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"标签:"}},[n("el-select",{attrs:{"value-key":"title",multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"搜索标签"},model:{value:e.model.tags,callback:function(t){e.$set(e.model,"tags",t)},expression:"model.tags"}},e._l(e.tagListOptions,(function(e,t){return n("el-option",{key:t,attrs:{label:e.title,value:e}})})),1)],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"分类:"}},[n("el-select",{attrs:{"value-key":"name",filterable:"","allow-create":"","default-first-option":"",placeholder:"搜索分类"},model:{value:e.model.category,callback:function(t){e.$set(e.model,"category",t)},expression:"model.category"}},e._l(e.catListOptions,(function(e,t){return n("el-option",{key:t,attrs:{label:e.name,value:e}})})),1)],1),n("el-form-item",{attrs:{label:"缩略图:"}},[n("el-upload",{attrs:{"list-type":"picture-card",accept:"image/*",headers:e.getAuthHeaders(),action:e.uploadUrl,"on-preview":e.handlePictureCardPreview,"on-success":e.UploadSuccess,"on-remove":e.handleRemove}},[n("i",{staticClass:"el-icon-plus"})]),n("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("img",{attrs:{width:"100%",src:e.model.thumbnail}})])],1),n("mavon-editor",{model:{value:e.model.content,callback:function(t){e.$set(e.model,"content",t)},expression:"model.content"}}),n("el-form-item",[n("el-button",{attrs:{type:"primary","native-type":"submit"}},[e._v("保存")])],1)],1)],1)])},a=[],i=(n("96cf"),n("3b8d")),o=n("8691"),c=n("c405"),s=n("8020"),u=n("2612"),l={name:"PostDetail",props:["id"],data:function(){return{model:{},rules:{title:[{required:!0,message:"文章标题不可为空~",trigger:"blur"}]},dialogVisible:!1,loading:!1,pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},userListOptions:[],tagListOptions:[],catListOptions:[]}},methods:{handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.model.thumbnail=e.url,this.dialogVisible=!0},fetchArticle:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["c"])(this.id);case 2:t=e.sent,200===t.code&&(this.model=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchCategories:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["c"])();case 2:t=e.sent,200===t.code&&(this.catListOptions=t.data.categories);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchAuthors:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(u["e"])();case 2:t=e.sent,200===t.code&&(this.userListOptions=t.data.users);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),fetchTags:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["d"])();case 2:t=e.sent,200===t.code&&(this.tagListOptions=t.data.tags);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),save:function(e){var t=this;this.loading=!0,this.$refs[e].validate(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(n){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!n){e.next=13;break}if(!t.id){e.next=7;break}return e.next=4,Object(o["e"])(t.id,t.model);case 4:r=e.sent,e.next=10;break;case 7:return e.next=9,Object(o["a"])(t.model);case 9:r=e.sent;case 10:200===r.code&&(t.loading=!1,t.$router.push("/post/list?refresh=1"),t.$message({type:"success",message:"保存成功~"})),e.next=14;break;case 13:t.$message.error("验证失败~");case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},UploadSuccess:function(e){this.$set(this.model,"img",e.url)}},created:function(){this.id&&this.fetchArticle(),this.fetchCategories(),this.fetchAuthors(),this.fetchTags()}},d=l,f=(n("d04d"),n("2877")),m=Object(f["a"])(d,r,a,!1,null,"28452798",null);t["default"]=m.exports},8020:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n("b775");function a(e){return Object(r["a"])({url:"tags",method:"get",params:e})}function i(e){return Object(r["a"])({url:"tags/".concat(e),method:"get"})}function o(e){return Object(r["a"])({url:"tags",method:"post",data:e})}function c(e,t){return Object(r["a"])({url:"tags/".concat(e),method:"patch",data:t})}function s(e){return Object(r["a"])({url:"tags/".concat(e),method:"delete"})}},8691:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n("b775");function a(e){return Object(r["a"])({url:"articles/".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"articles",method:"get",params:e})}function o(e){return Object(r["a"])({url:"articles",method:"post",data:e})}function c(e,t){return Object(r["a"])({url:"articles/".concat(e),method:"patch",data:t})}function s(e){return Object(r["a"])({url:"articles/".concat(e),method:"delete"})}},b66c:function(e,t,n){},c405:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n("b775");function a(e){return Object(r["a"])({url:"categories/".concat(e),method:"get"})}function i(e){return Object(r["a"])({url:"categories",method:"get",params:e})}function o(e){return Object(r["a"])({url:"categories",method:"post",data:e})}function c(e,t){return Object(r["a"])({url:"categories/".concat(e),method:"patch",data:t})}function s(e){return Object(r["a"])({url:"categories/".concat(e),method:"delete"})}},d04d:function(e,t,n){"use strict";var r=n("b66c"),a=n.n(r);a.a}}]);